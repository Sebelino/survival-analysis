---
title: "Survival Analysis: Take-home Exam"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

# AI disclosure

ChatGPT was used to review my solutions and for grammar and clarity checks.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, comment = "")
```

# A.1.

Let \(\lambda_1 = \lambda\exp(\beta x)\).
Then the proportional hazards model has a survival time function
of the form:

\begin{align*}
    & S(t|x) \\
    =& S_0(t)^{\exp(\beta x)} \\
    =& \exp(-\lambda t^k)^{\exp(\beta x)} \\
    =& \exp(-\lambda t^k\exp(\beta x)) \\
    =& \exp(-\lambda\exp(\beta x) t^k) \\
    =& \exp(-\lambda_1 t^k) \\
\end{align*}

which has the form of a Weibull distribution
with shape parameter $k$ and scale parameter
\(\lambda_1 = \lambda\exp(-k\tilde{\beta} x)\).

# A.2.

Let \(\lambda_2 = \lambda\exp(-k\tilde{\beta} x)\).
Then the accelerated survival time model has a survival time function
of the form:

\begin{align*}
    & S(t|x) \\
    =& S_0(t \exp(-\tilde{\beta} x)) \\
    =& \exp(-\lambda(t \exp(-\tilde{\beta} x))^k) \\
    =& \exp(-\lambda t^k \exp(-\tilde{\beta} x)^k) \\
    =& \exp(-\lambda t^k \exp(-k\tilde{\beta} x)) \\
    =& \exp(-\lambda\exp(-k\tilde{\beta} x) t^k) \\
    =& \exp(-\lambda_2 t^k ) \\
\end{align*}

which has the form of a Weibull distribution
with shape parameter $k$ and scale parameter
\(\lambda_2 = \lambda\exp(-k\tilde{\beta} x)\).

# A.3.

Proportional hazards model survival function:
\[\exp(-\lambda\exp(\beta x) t^k)\]
Accelerated survival time model survival function:
\[\exp(-\lambda\exp(-k\tilde{\beta} x) t^k)\]
We see that the survival functions are equal if
the log hazard ratio is related to the log time ratio like so:
\[\beta = -k\tilde{\beta}\]

# B.1.

# B.2.

# C.1.

# C.2.

# C.3.

# C.4.

# D.1.

# D.2.

# D.3.

# D.4.

# E.1.

# E.2.

# E.3.

# E.4.

# F.1.

# F.2.


```{r, message=FALSE}
library(biostat3) # colon
library(dplyr)
```
